# 如何确定管理员账户

## 管理员账户的定义

管理员账户是**部署合约时使用的账户**。根据部署脚本，管理员被设置为部署者（deployer）的地址。

## 查看管理员账户的方法

### 方法 1：在页面上查看（最简单）

**页面会自动显示管理员地址：**

1. 连接钱包后，在页面顶部的连接状态区域
2. 你会看到：
   - **Contract:** 合约地址
   - **Admin:** 管理员地址（例如：`0x9fE4...fa6e0`）
   - **✓ You are admin** - 如果你的账户是管理员，会显示这个标签

### 方法 2：通过浏览器控制台查看

打开浏览器开发者工具（F12），在控制台运行：

```javascript
// 查看当前连接的账户
const accounts = await window.ethereum.request({ method: "eth_accounts" });
console.log("Your account:", accounts[0]);

// 查看合约的管理员地址（需要合约已加载）
// 在 React DevTools 中查看 voting.admin
```

### 方法 3：查看部署日志

当你运行部署命令时，日志会显示部署者账户：

```powershell
# 部署到 localhost
npx hardhat deploy --network localhost

# 输出示例：
# deploying "Voting" (tx: 0x...) ... deployed at 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
# Voting contract:  0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
```

**部署时使用的账户就是管理员账户。**

### 方法 4：查看 Hardhat 节点输出的账户

如果你使用本地 Hardhat 节点，启动时会显示所有账户：

```powershell
npx hardhat node

# 输出示例：
# Account #0: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (10000 ETH)
# Account #1: 0x70997970C51812dc3A010C7d01b50e0d17dc79C8 (10000 ETH)
# ...
```

**默认情况下，Account #0 是部署者账户，也就是管理员账户。**

### 方法 5：在 MetaMask 中确认

1. **查看部署时使用的账户**
   - 部署合约时，MetaMask 会弹出确认窗口
   - 确认窗口显示的账户就是管理员账户

2. **查看当前连接的账户**
   - 点击 MetaMask 扩展图标
   - 顶部显示的账户就是当前连接的账户
   - 如果这个账户与管理员地址匹配，你就是管理员

## 如何确认你的账户是否是管理员

### 在页面上检查

1. **打开投票详情页面**
   - 选择一个投票，查看详情

2. **查看是否显示 "Admin Controls"**
   - 如果页面底部有**黄色背景的 "Admin Controls"** 区域
   - 说明你当前连接的账户**是管理员**

3. **查看连接状态区域**
   - 如果显示 **"✓ You are admin"** 标签
   - 说明你当前连接的账户**是管理员**

### 通过代码检查

页面会自动检查：
- 从合约读取 `admin` 地址
- 与当前连接的账户比较
- 如果匹配，`isAdmin` 为 `true`

## 常见场景

### 场景 1：本地开发（Localhost）

**管理员账户：**
- 如果你使用 Hardhat 节点：通常是 `Account #0`
- 地址通常是：`0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266`

**如何确认：**
1. 部署合约时注意 MetaMask 显示的账户
2. 或在页面顶部查看 "Admin:" 显示的管理员地址

### 场景 2：Sepolia 测试网

**管理员账户：**
- 部署合约时使用的账户
- 通常是你的 MetaMask 账户或配置的 `SEPOLIA_PRIVATE_KEY` 对应的账户

**如何确认：**
1. 检查部署命令使用的账户
2. 或在页面顶部查看 "Admin:" 显示的管理员地址

## 如何切换管理员账户

### 如果你想使用不同的账户作为管理员

**重新部署合约：**

1. **使用新的账户部署**
   ```powershell
   # 确保 MetaMask 中使用想要的账户
   # 或配置 SEPOLIA_PRIVATE_KEY 为新的私钥
   npx hardhat deploy --network localhost  # 或 sepolia
   ```

2. **这样新账户就会成为管理员**

### 注意

- ⚠️ **合约部署后，管理员地址无法更改**（在构造函数中设置为 `immutable`）
- ⚠️ **如果需要更改管理员，必须重新部署合约**
- ⚠️ **重新部署后，旧合约的数据会丢失**

## 快速检查清单

✅ **检查你是否是管理员：**

1. [ ] 连接钱包到页面
2. [ ] 查看页面顶部连接状态区域
3. [ ] 检查是否显示 "Admin: 0x..." 和管理员地址
4. [ ] 检查是否显示 "✓ You are admin" 标签
5. [ ] 打开一个投票详情
6. [ ] 检查页面底部是否有 "Admin Controls" 区域（黄色背景）

**如果以上都满足，你就是管理员！**

## 如果看不到管理员信息

**可能的原因：**

1. **合约未部署**
   - 解决：先部署合约

2. **钱包未连接**
   - 解决：连接 MetaMask 钱包

3. **网络不匹配**
   - 解决：切换到正确的网络（localhost 或 Sepolia）

4. **合约地址未配置**
   - 解决：检查 `deployedContracts.ts` 中的地址是否正确

## 管理员功能

管理员可以：

- ✅ **创建投票**（所有人也可以）
- ✅ **解密投票结果**（只有管理员可以）
- ✅ **允许解密特定选项**（只有管理员可以）

非管理员只能：

- ✅ **创建投票**
- ✅ **投票**
- ✅ **查看解密后的结果**（如果管理员已解密）

## 总结

**最简单的查看方法：**

1. 连接钱包
2. 查看页面顶部连接状态区域
3. 你会看到 "Admin: 0x..." 和管理员地址
4. 如果显示 "✓ You are admin"，你就是管理员

**如果页面显示你是管理员，但没有看到 "Admin Controls"：**

- 确保你选择并打开了一个投票详情页面
- "Admin Controls" 区域在投票详情页面的底部（黄色背景）

